%! TEX root = ./main.tex

\section{Recursive Queries}
\begin{itemize}
    \item Repeatedly execute the same query
    \item Stop when it converges
        \begin{itemize}
            \item I.e. when answer does not change
        \end{itemize}
    \item Steps
        \begin{itemize}
            \item Set \verb+R = Empty+
            \item Run \verb+(base query UNION recursive query)+ and set it as the new \verb+R+
                \begin{itemize}
                    \item Repeat until \verb+R+ does not change
                \end{itemize}
            \item Query \verb+R+
        \end{itemize}
    \item SQL
        \begin{itemize}
            \item
\begin{verbatim}
WITH RECURSIVE some_table(some_attribute) AS
    (<base query>
UNION
    <recursive query>)
<Final Query involving some_table and other relations>
\end{verbatim}
                \begin{itemize}
                    \item \verb+some_table(some_attribute)+ is the recursive table
                        \begin{itemize}
                            \item Can have any number of attributes
                        \end{itemize}
                    \item \verb+<base query>+ is run only once at the beginning and populates \verb+some_table+
                    \item \verb+<recursive query>+ queries \verb+some_table+ and updates it
                    \item \verb+<Final Query>+ run one after \verb+some_table+ converges
                \end{itemize}
        \end{itemize}
    \item Recursion can be infinite
        \begin{itemize}
            \item Will not terminate
            \item An error will be thrown
        \end{itemize}
    \item \verb+UNION ALL+ makes bag semantics and may cause infinite recursion when replaces \verb+UNION+
    \item Relational model is not well suited for recursion
        \begin{itemize}
            \item SQL is based on FOL and FOL cannot express recursion
            \item Other DBs types support recursion more nicely
        \end{itemize}
\end{itemize}
